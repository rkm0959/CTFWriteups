from pwn import * 
from sage.all import *
from tqdm import tqdm

HOST = "127.0.0.1"
conn = remote(HOST, 9005)

q = 250007
n = 100

Py = PolynomialRing(GF(q), 'y')
y = Py.gen()

Fcoef = eval(conn.recvline())

F = 0
for i in range(n + 1):
    F += Fcoef[i] * (y ** i)

GFy = GF(q ** n, 'y', modulus = F)

def trace(v):
    ret = 0
    for i in range(n):
        ret += v 
        v = v ** q
    return int(GF(q)(ret))

for i in tqdm(range(100)):
    isok = False
    for _ in range(30):
        coef = eval(conn.recvline())
        sp = 0
        for j in range(n):
            sp += coef[j] * (y ** j)
        sp = GFy(sp)
        tr = trace(sp)
        if 52000 < tr < q - 52000:
            isok = True 
        print(tr)
    if isok:
        conn.sendline(b"1")
    else:
        conn.sendline(b"0")

print(conn.recvline())