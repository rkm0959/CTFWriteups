from sage.all import *
import hashlib 
import random as rand 
from tqdm import tqdm
from Crypto.Util.number import getPrime, GCD, isPrime, inverse, long_to_bytes, bytes_to_long
from Crypto.Cipher import AES

gift = 591703505189598943502532470020819444351417786427559744959297594254824122978178246387758678525460348647607323681851133469704389837929291231299720334741407700827989408054546225374329432172907884326972068507016216598037334968580880320
chimera = [(150537688277394724566197968212390205875784906519901611370605254399607407437980304206582098599056830027149423929945815730858001338431839585369407009637748432651827323878017187239276857469452444024135954765231658366849485393012747765635533821852086136803022052042786659756811011093368782655591552626380915210232283486956689927924730055612264905511776580258361224071200849769384642341236213231176260395984241645023375707620029611416184256382190133918793315186815655, 20534583494602522250069814551679553120873239207531072799027591631788187429641056090399679699592983836226923394053174153896279194995777471830012806245298643944885965695230745663930960019707218975330771911897675530788650489470550370131872328462768854584162849900180030264557384792185045598939236070533710443761558309089794688476114979633302008525846062266580799466123897832093225172401358406077756664479489002696159817124538910643085082406871986158417629042740685), (207225965632023232270721937919617010268920044941021769337455087296218358519474010424378055962675901396295161529899763223663967268391130868048579071679724770560658225221418226798923662535069330222486083513663695536585044290606776384640460214405000306559314178642010126956919606976163783691178329445556278856256931282835657627813397986473987727122244502961034722014644672599147500855910976678133185786323800251236370241667187139840571696759025873511222321127308155, 65297767149042459136729305839674444130550487010141945434700915278252099796938979527951139220020104625539316397274509645600326567108506881960073150050179124575522168353606802580893093694785062105808150278636357183870221775927063206274079228890238017872792831646615451193880485002488008196156707579602748039014263812843224466500283428889098348752892788540462048635914796392588531398736956067798227356387771560397829886007222575237616137892892980729276346521106570), (221987869428826242642373356921661216506654873130257716908058799350370897015067327297209822482590187204819373241806263256943116832090426814820129101526821882362488220707116639254927632487239016892146247122138846580010909505618431165854255734735536659256410168589260700860038221180117796376162321296923998281853809857436898991381183411420136275331893176080238760850720365247800106162562558728016857323421920465222398495537361680583386406533838710224863182690085313, 192861627358364809756312619523831031744249116504655489332498346242105213747414404650418768433506521487666695621656721226720095730415208737738625581904251076272752858671648945213013102308598294718113957891663338865934295112350525512948015538356268908529076510563210826324999939381069417053274285848929455468935828177967616355751825994204348858927702519932685131024890687473514096694626594337364762349195801727504831879201683695674397165604997869011570943328509154), (52260991203418037165530318852153412014366743168876818942143284633376708538875529024827257819086657436635750362874695370021755641897570218584781269187408542039736685164080410713721320952147878435828938903443105755915825237126473757747230164571350283951999112391661289949974089778568208330851769439840882309983215731272426884688751544755372247579757474561524056357915480688655007421114437485334094152067993560951018656373829092441460634553612812633316580183654098, 268557894193083851563161158284304990486800158539816447387952775416115158077336540729519320049722422241058043903927947922773906053983896200164853412626951383628692371279582549603433661507624923252154506200196156690899220504078738033197018146531665684394886527406765530466221705902311921892497750989940687389346172122736839429600003551265985833203278011417534174153572736380906562755336542213792765228889769358645728806898557968067687645322419228521515610958200460), (250593976405358841101893544162499813188153875806117362833528442705614559189128919835960428400858582847841190821292348407490587136719605599039438623310234177352842675666231918947377347742002042550056574860035411601473894010932226085800165070992302399597907719708809744917138379252101782611549309798411056416376367624154018521621367029777753918740519615481998217903621200172809145435914660649467445862696725603083455420207066165930381376288548497108849224316438901, 349929197480806075338521943390619942151925272979545880606727079366490697166700117246768848310612205070633060077444800622235174769909664615922688075351316788225572307878346166102131161887562932948103750957510161677879469248559196437897151959854696663720155809339459908021902169288749711802350771190024553297879467113991097286710398591084374527858118213198241707013114980363231351324402306780450286375436558347525963867602556073840027482088420902576000306977893113), (280029814226844980266329998054675164129758693915013656048596720534080174218169482730737691988271834891416245479810342770481667787421793976261856588852424521805862447620178611261998772177407833300468914298547561140868680243104724168615627571003019729307976684142432541499846403223245358877967284439514124275044844075676985125810871630968484421271107443704431431445791549453970132619932143564069422333191707402117472129871491849448542066904809206971249583003963005, 62933689763195909274072029159754302447147894391947727308874969461451962598636943988239047865292932480026754900468278615704929778198285163036366683507992888505843459675092235102874924382662058690095475570463868419012755483723751487909743405357699212090396837906067236853260020543611773994846761926636077469622982017757656860672084275512375592955100039637915765425050928855492957825667417925438593254825400720040318210768237428611591885157715350599456670848895005), (109236583168676728639375729249437728557346457221506878126398907696885604402778570924000454321826138157316307393383245242177310667225580198590798197529050604344605275374441452888481061443062364894234358862041341453301451377180366581980533039721001434795490059944220802159842381624843893647440689705888275138255480333025767427479690286333990246640238916267247282731885752627539121400069312304007036801316744162017508195362361344762393906623857458673027781776695206, 161540320580805926528420681668468758541793738799191918112154890656767006006298949553876899326548213129018117163596117782606737325862126901000442888102339497701802708166712046269271838969807011863536205655107958945947996873702884336958174676434888387313069182050315345175558332811216273514726122792374445282914163167665633072980324956843334450371772309570813451004054324453114703874099814410130108579903244260949264886786779831156843399181883478025433670149172378), (303434543055281555913529761243468184746152543457543047319739755853471511070110775256499592631069263509174905134040641143286107530713946285607642260200352575855734638779385929747921885223463579187908453903267008004106431564601489891929261310875925643076757796721112050784538080247767751152744098059283336909682566599052174772335619136498003643323966868098640742066981371522747991006463325347543104507032962808880282024920623237390484786879824578479842435772391222, 273973593023305915027350424085065459267368275353545552807483870232775907396873350630605254484987822028074810685035594076341960964515120904676576153133611185399798334346843295149444411651675869047176040758034242174828431736424567561841559456292601731935717492743390073442248870745980795110689828579376539102034474135052429105876219497651077100516570498084323918091942793401914885061912995399110672685851048707045267761512129336312030687614582659042223362526643204), (295235378269890295640427967422661269655465105324738915779316780498077982470650021995738989522192527757626633334163791957415858621823629954063538018884009475239469957175127646027287677805298036685678996840482386980748521753505097509141572807195292286572334383846926608082571215592506044125027676018037265682311723089079367795130027968451395110691215392898080750373645816560003017717527744771580662335873942182306865748818710904342667596259317266339339097554346440, 275400743119016618364569904074131029543377539708438513966639422760009517664719402680510058004893567891715558458705812397118272932869591759049086298803354088368767008221649645491707949763333882949447879789086166352952785699912546638233439393599859515787627462557377782784805867802240304587209853088559480255743478549327754314028626000942966296430371753999206309677253945938808000362656922930901543124195867728715847444107886672871043767977300712596501802749593416), (218096465161861100470137866138754915777401973389864156795640892990864043048744329557271345585604250547883569765619343063408009453757299036233729596028734360427645995178847376345965843229594354306280782718585936784834074388794030710692805590650974808842042783817028098972408480260489676926445742172602721648811422329320545429468651448314024186981708276620414087974872639053278949421135343632557011524454149037524867746528420256129854058341682738160483561863180077, 162089203893030740846864759746923326380618624663991907812539134758257186350812192270358550581435809955080351129313504492871983103091064096786668016751521101478803585197364451198108304331022977064687298121286523883587646222982658683540416335455186916857309939947857722577648101909931075353082797905097694255288877752144512886326386318239368180884426053999660554710689445068662478130971686523878845263815710265765339515659220678031318688557922649239602871462836490), (284464972127578602791031921387515586975668009686915128923673183016616721060966748391107103922836559606520841949517137749667519696692942838326573711082129463535529556584820391572581884299052238534274674716471865552061591225700019620860039705582955434807258860275838991409987977210641216874296852344186578950604796711190868226549330827202552433055080131822320119118090461961244108688431915530417654742838200416831917878596487061187308023231817375409614224393296231, 320123611881800508784923288759973176631484490560897893384348473191535454122751319382092698140495657615520825144314186108304682202232059675298120313846732021441125993414104015130257260334527022641056520770014718813559656985631248247749371323952906841149043589462412278950097360971692808081625105312024003019086382832504087841921656533256800993034582086247993524807439962781140795802257391591176601750348152068633555196811856407423924504005228132125342065064099870), (23095057893247508067179887601980930439366774424019434008086009239968343421881679228009705628798632361914579051911807813730082995345478327618172789984374239853110118600492049049389941772784015191841213533583337573667996389921984712668592844914739431215197051327887391506584509691548670795926007054477635017770726423634399759260657081451837187716167066261199922045221141652211732229711402481371815899095193934820144162324630725147899172002194765482874278349371668, 74575625414922123305688089202687773914434497044848984617828821720223295692868915245503294703377493469550161130647689491513383936043516734314004126396565971804325402132187872746689461792704775013078667085985080408387211681682482482968614895659345138312986364660415816712019172577460112435427674215944042710773612769550305719876132143235254289443228537716435064232741648969619993951782393091919756087870516638632324369174784571566625861542332798905141139628356065), (241113861537350262386540242605265908977563123872642373777823953079643869142213389424235700880521472734370554137088683545601476384802080781732678347638891758413669706979125112948111182698412925148168902790821740466106504515771583491497607773727550270481681923395594698607670108897074269404638496067062298051855693048910403461602315544620073335290422079184730907010772500287522760796664593736722719529053268860301734321584721938461049957143077202474110695925492475, 111476940361803369235598296194251646667398753511191428002212832079194964744370485286921296395092812613628360833636721335987113720812088219631271461973085017583677061162369438145386410266270839556005140386539861424081503293536129536334222280231307362181628186818256434410079270867556749456116716334039649530531169658995914515639504810028464336234663987853430127367233537191063206875593562311875736306568952034783987137054263179942445111218414275514331335089425833), (340130793581178278734171917077492989301865307103380033933930206814642648181828393490739705208724097137947274592267371751117628100214884064350284794539701790813305102515854224558962305427476810510788871597271065613581174611378634034451364939209910034785338287253101337710781689976749418573145633483386923746481023345921691051048519427466211423325886991227066788088838015604301641154363218571377493678784636259413035069805800577181335367884156977345387273438446088, 341735345054271485791242357504592122323370361943371482170340726380530048506299664089208382574216259729097426982536756014231403310049487769227847387354643829695554664753232853400316730920334445966987375103781198727813655755595984125291078816327738197658489492686851155797439853863962008912430859025673940860109556835987645627482598170272975087824011216713353832085012163676790054263036147135777045331745493516811310259213421025646855375711413408655065623220025562), (309039653515918727555456874666730628540543438741485346944258272081653664543320394239683449110172553821245658864174391207633326668254315369904014689564663807905763256471930829053443729463760742711148564044037779612206065736403809206752885564979630501854830755811360134445767647167426151571860192124751463269983007849713422604055489143159921829144592827449867686383277702983763906487324110476031579772665129508820020766555687758398493930173330880091059757710986310, 85557024640510799958665986707137235492012109229837681042972653646561448047701648901294600945210283729262795781590403223597965758680105444740306019114280066102443717157000467134624188046232329940808698479808075297431937867458488040347702081463073082813730015850191414113065727253847278808181449993290266134779680359289038190011532699143492101383227822940987165679028511863170837471047049391433787326007612650626064804398891302422197008518111701539191876371936602), (71228098235074090527313874937974043631666590704752640773438773390487293948713579169182023776977324904085512441978145385871418697832281127857931392549008349208647780582940066325115851463470027437368687296035191729438509445018938970280495412382987590258664812236209154874991836393392995840706606107921596348694432412709463448695604432787810324407255842177316422286735323442376363615728633972375675337740745427017081119414646325998969698362441801546668874987188169, 115108674291234842010810079901876608925406456606747333395434112474842511538344644705789023047142938337810584351813861322923127447402774686117353783475761860449455130481953194110131630117974266673319317601422458288473517430964568299108055095086875360656265010088753872299011931567827029380559224686558972902234111290370968660259210418651486806775894038039766842823128376729267010827015733536919892124018678802116360191327277546474216393893802842926077614952458717), (228814797898062790655514164167566685853285881374417718499965803273663838141047359443237137729319285436712975294418704073985213948365576815272780802382351738279498405146271241480426728970339414657714436627665463761853592533646623893412563486115680774849560192655719281765291587565658564847365773693861903577595353985719305458242220200832740288766733771633764181294166687269802125938730917408782513592443649115650339386883565015022873819301391819674608318195266881, 54314817657228649736624778128463871791604206845114147254793995796031307853533020642325784917060781509877524254573381405392305743796653737897443587972776797162403165454849710774877355657524710798090878259997933374579190055880285633410983801875196959643906302279983205226196751175483209214968783269853161658437301109479469827889598390272275274512092515765779213554884468006342102721817797302920863211380377623738667557796602740850760352255019576521423027982902611), (229442701216788612873168818901192062871649946324759811106699583892993382106432041288651475017841608752697679798459776041311186159819068787432232479024636524220273490719888913566655634586161498634541869693035491465534628454375876592035531139901702476656075983941923141488808306400992362383012079283927736763673337190564617418114296157604715994838393707753517311700568337243055450625043309786466453293245337497232326702973439266776815779972333786699509738075848989, 101887432868720032487359714460369289531720360173438666748385983574761098429291394235817446128475592559289815194314202056270037106347564650730931467347844271464472839451911685052554155323765734537270976500889283843696976577513032533840561577565551941179881891589939523143414166293379094884436401684021246777113712616151966323862970449392036311520791480878809826816571439739494330399684882198214615436032466899374973950088388379340833980968323483115910699559923782), (26765306086670427649982354101583566509609321940207686644101782134709843014663389418795496609847286514828979738910492725097071640286225832870447976084652457375031520760431390394817980207643764978163099702381787954364779056778744149344833824342051480771582813150531070358967057781775779909535735102979554666310469714670816465409614864257757481494142381274742791396410377145146376917638533840159582230847598536925403401763935638230362455978798753286325365660679061, 229099284480182330778642033861206559562005154603874854324057359106206283232683097660657156076962647850063630845407121166893268925056200095892595029031614352126639073723664896959012001157430025621701094995608615448398640344659569748860171001441499714023403239007799261078496413637010657836921949799510327968561433693802924235285282193440570661303159932438802436217739686276370906934041378584159438057261059250496735071050198927762453469658473577905643554795915736), (188295612609439523401311536389945987814028986539681991176016128261045771141330347024237649979067075401805549821542704504419368466745954579179683003691589225045275357833346024414083403189781729091500681347354323334136612605907857591315961705365735095322884018734030980624219625638973234957255199063974148885689965734996688472107836308299771171358864539764081322520883684014199941508285506960251931258221069072893819042417763746249199864286955155095973916266556221, 180563612110494545156596262283289900298907136573674762795380034126840862740583635527084349964108293112822174922174125964790418922847511968667443359275723432458527817185881524892825578407694652783664592288385094419004326305932953011505088611486695333906812520647932481321589958923439577823766916666272632169008790161802416292776477366066246468231608263502819729890372790984612715436872736909691096416093504083177304154756972924673862464041587155126861091894341395), (66137185571555048685030777838090280054135490839239337605225448529617459074315465846118859908483777528542485070025748503487803564647940808942858301974267888083056176645134100419602515024523935473503835460506422085161576434313580991552393658071828595974396463122774518628614103695047077053202234353128497097232436911240904929767348289731394795091561757969182508253310607358503737454864822179854101676802723063520690033761053540079921685703333965653841357496117881, 283952916209437619914887808149255635788264756886158536087617105907849190840216854282412942022999501394617607569194458339660321712694589253083610140939880158627049341517505817508593235398323751084885114698845241234035957658827183586924671672608208286346321969589481459688519101422269479882906175696972456646087740284592292143370082100016143676468389306235804764586322479298886188290910312649804874389882269050581940507138525478940413281569154263058527968700067879), (49546567148237680795579122129714110459642551277805885257432183116856241275638153834942623320255563025067149971786633782027889912009620451440414648026886257527974748496439261747699984036921286079590038154762124869635252216242220155036849676986057441268573041229830250794020495733658289424306972928379785318467528593774612617386090506111492099751512090922936337658061288622838198073918127709691623961842642362723022681604048629898181071194328901960486374277996933, 341626140597280141118081436590187007143749644125434643237628551920107592110816107056591859821112877134943352925095204775728302720915335334099789643928230745825139392166493348042334800293017154696013665221757473421600554507514382033928400968150715757921795529041562318006872329524966295956060408770700579249374744399432616942477546384915843465292027152971429085892495021707969246347602686534440783660272834870243008049322471807026343824954251616424349501651562097), (56893538824763284743072295209048987541070779714679710627303692616381470793541492354656660981842372187131482845528643152472134891087573102425652624107206095986386280286468555662560250517810190953722807730962022194716774603916932555807360199285708662675973252895154940731932442249505995961533424699172787485546564263364623907011434543237884455641699967572438977446938324663625812620197295029997734481731714543305498787829588015703408966995476321129014956001483159, 75352793713465372479525320851465958835066388430167425252685437015701703246334098847876161992974712973537287318260825392566975664501287518142438052709276653043230221103227177199998740996619008839292528700008761113539049741856743293472590388255411168621580538579955437001493916823460423486317664424475938417265383868983954538815866473334644804692202535459078942368828008918671944911637293656980182574562235480224900867233918305652939217151165673813625288580672133), (89447713673927224384021607934921788792937495806986853573718972337226638295105441737634472545283285903089358058574983686046516127249992443755561524122053956251222936690467498239426957669761101592948181847688034693466285502860535871047411536909915621405419584269267229053782273818666539461642136141060790122076311756454769623874006312441167630762567019342694951597300512038163984973603978657620740861195904753076400775273013628023685577098565998815280616290065156, 303712394518246972520962062245184304273582183706138357517855636635524480338664113324127430941048078954586610093095282138446416197842116351905844422002738833431155457772690749351170283005903533282517145068785631022817213971501883184547714061656341547419227789857968795522638498284344590730740501160252733984554224841244245789237326395541236030217384167367105184194316565432567188451994054152278985170718388324557533096239885908566328032400106181250889195275249121), (321421870132964125376722899013325660736134334106127714214931378031351916040694310237963344604673950891285940638007198917596908078410969248285994552528190180698268084986348635266531578152727954177242130290637433119905586455638556569188792903370108131204620221513065889173291159482831501407323879705789427905401094298398371991247214312645021318162241448656015033279684667340706179131537983833897951366490301864167700137486122947479636141297113710618018342366924257, 201868114327630676581729671953506225299683897336426947445153006477540532560769775753392361192749012590482695971544693596972236277303310780346281633019126404624789156305783021451097464264666466188600560553406179781229766592131912250678535857703442503548601802633201494390487968493977857216463683285323355614559298163008871666542965917538531137483869210535407688015028865763462956587292453028998173918045658749908956851263999987772117663368949676160214501149458635), (326240144795127607868499666745833822534804931016434072082271143257674870254758664518095218426768990573249075869181973668327881478722887997073365213372838820864778742810645544379447349121500369615442654547696019013925833010976407207962496444728151544791426752283366996370051737093143639915563018529619280334632736934222115560100169054550204339544615735508699255321126557718526630533704434524764632511496729937161573115471072674273879791794562114847815996152219333, 127074199751521766660427121717818119290362225074706904515827313100803743595070985066639412825724737445483202563264512045787174216995875264863093948364587904277694370079741565556184400263000585850404364083448546069252980886854001846033981158562728493542155498430860246045083635330033837585417470165528859709701462540271243299760323727430078851034418861351103713602149005394497046875450585501205354217518055569438649726908554509701175343190670139795101990561446563), (249348606897361205920699631975152854409145261583813208055557970601812259679209518927062331560326591225901682505377842724197401936587116494612731707960098661395614971605009701644134627120033142224601005793716234943466293680900073788071732301492586721061754545262889670541875129127672894246096947797467724570098421685581183895775048105091622080608282941856914492658962119892356404009373613760413769694326210412987870938497275703848334263141637779015110582607960380, 129173455647011468643955756610738465794438007806670160477156430418886118632868966109093384698172038247251374557300786739202168113334559509906591411454627440063222283416640593345959090685418497094582361261537553776610291589161369870794259205263434472152052382533439437836702902395839868977903294005690842931859302904298789720764021519740177280632929772991436490699968043702800008043759987994452323672995799261774384258575552893220195037735380718584737324915565436), (95987194451906995947737075336790080304311603222428500643165377749393369907949212989578848719656615815334778695718568654944526006565856986943196069642751196584949498704401266838736377198667173823369557758800639021447047664788736515294060675011734941816515760082797769826999029063265857690970987206597462951882247919958790685823208542138516124337832250766561992444057288267222633723733487804884029419610637321146278119475945037477983514355954757315377688952144724, 184510857825748436094675519583417731865709565112158140223921799870952509078313320941798497387436061852127601364812498291456842082356804093429989852693271915000643562862634701024274078337473101700390813891783364208139924946213318054473539600042265386661643340851316448310172927441431682604768503002280546844892534161961721255223665294408003206322611824743030767711007741440090579986916025808490365200667369845060121521193836372610055849082053874237698319282766355), (162054312478535377654565577945144105040545172758310009447110052409165607634487249192145924069957103772765630791481743147327266089542772199186738417043276905941509397154791699056302315697486028057802551454071089357148331729130136554663184576779654933502719945742408730782723892864712068898241566995048711221525581993684934351207746797228679337759536913463618315972511897203133420751971674249154135773531294023925889275082736446652910509279296802999792430362550329, 49843011043411612248197170286907121544598402143825092811071763919798350412628072711113037147484863669732610241241984939398319149039988984857566507768448978561261397053355693669475848337843944294634875988040756301802783032010649416431934973678608075522829314574817091947096565192227032296642163659454821831249598943865159386206900882512444397347803020160165578539285287793011513179630026888652618714352687172618269524312622739501128376056592655322411404604693619), (73254389221730576431655754246780475557022222053855628027256822494626766103604426774511343431612082270572364958608050365993411442623000095772258074439809365773104037227585152335996940875329706019075944894750024204660143694773806737309537418641183400649853276970321599706442201017919020421028122523209248503692982424908367871419503707841247224495871922187407371806897725213312001495592420093882355353954361762963380190078262386417599534038916040070851511474751540, 62286839791652489471218905795068895957931331422518160441294992554872792090071512104692306723186863539453570642031966215150286396978228890418764475717775768702595911219826628434019601644611901291709028868298859139854489868875443554393954404066427278481810366748916838493814470729006616985022812992655863344014725118008027753222066731791146922053669496461446860086124157501815770128813089466532877626711876431713049057456816721069101241725539025660336382459973829), (166998390131865375106346434803453951598332686568568996313779137835986464698534086292933917909480127355748938309728388873905735674320550845710363022889008467003600841894741663841904156825294637908129958911400157852748126419418658631613886314897581756667642075987961710696542751607790335477743703417598389419850301180243074323012864391345821233518046509238993304572527179851780150113157217010285635887722344904180689101384632705747204007256264443690535427204298614, 132642085658625500447210631612754491636670147661761813020957828079636754898216897419411659170135708739344657498313683646132160166448965933616807794617809322239855972468734629611539519697330160347715741801576605787331707679542478257302431205202655975466732638213184286482977664611871296192257124700919845004830717101462440371709270177680216412321653129308385390152727812891160507827676925011437144186437858634399185138163969108983836565112889573263734545889556459), (48639378850641424287911423852157242408489966686351508863899945746694208494079229808322887997868973956736553672616229733433883092708626905209112241044107237707879015043597342793041514769873562492280060303252564907348875314265617371481216782197451310439453412842564592789643798606086212787077273698046985148996865845814132214240449657857315605081445336199593813245233136072931352674784110739760454689457805730147600271900249723585441471785245880404631432239941263, 184647221299236702558927064505226030944254470871269926688610015731765173649122035483461945209913002542402692522254459287627456417935360713399139684863794968929581591304620259938795979226539709239855463200559641719758058686448055510017625234981508271063495626188945661064541275179263386859836541181058750348682549013169015123580071101140930749499118863486474605288326557162813124889708148434710637093846491532392991821885735859269822502030234304399369816175068283), (318931081998977002914508946198458115631243378217463601879269993233495929303312249936468787450929954150795150121329098104932815352001965684533348139010830615533407273850370758816322951195062304542462517819418267732007485802203369933190769043378342589675034521391132926723588803171533061719260685975350578201811346076069649169188382935333841162511317688748049185963188895951845898460629557525805830179605971247903595685769609774645342821026657353910655577606561191, 275150356649620313646455044545650683814452933040770770563987500478476789153940711115671758002308897807128505745132175318505422820065975318038786790194915928192313955319869981386939321636784700624824390514850156508495664769287061731437839959320628721773457564718032380724875977828646674385692210098952874503593601230138723087042876673780231406715711625496537157295550008995995562282121632771081281004540657087055120968719607855167565537684208936971688816272361840), (95230322276778748650759892746120747407415793850958466507805608213907293174351028569859414204649279383202424053465044474460127205850134929424445729853218631490667511373816932307860172681022557589595422311790462897580967025930561089143714089285977746086200523202131357504435418596767533932103893491050957272861787296168264918475137496243586341186479541318927293266992062626408194181147944025786170280329486724957334801379784073823561901448649081214239185877310707, 153351036453469513768002393533020508939779082372283839956936358937057239256859503472090585134882237901551558855752519569899513163621138607309848806560698321964777779113441518730150462275438822789894776957959738665851393385960113817539991144866301774899086644247490480212163595161722823653705113690806565673797471464821539453816470762723375620600719753099270004960306391221249001432203462345880142322923681951717528927016719207667253684635456867897762344760275814), (281007639838893224720368966654889686369727423185198909581012142178728835057804398124896540299219092617336577336006689923439795071919660545593977125317157009939979663922475111339483285716064497376195977697925816037615030622421190496332881873923055167148023917797546095053693992035135566719946563070627290267366214286709449256279325771040953957934974553126430767516676499561822225049014383293288543149387132964079716908009592873173900649660276432785136180767729628, 219679474895549602388361175353766970404677992279992270549885476142043898866436182627297682899813974701419669262493510844001812615653360001730199006358933767266149615639589798366815912246670952033304403547262558778380935043440893859884665239956569360297033085168942904299201455108500732542541142736840378512261073551438540556712407445790987600462552352026467013639329863141837144684799192675128466119335172649915679421722912766129278617093971153605939213529957872), (278179175558437028560006640381482284760609712890871268526657235793572820895349267426549817425649342599001077245701556122086669010519919727040546295808427163108476982036138816015906710358171530773039402233935805311365677185818526268978084242647643954193434192363450389905783100045138694234796983289045638975051588264149641224216408955128723664955632890311798701135285253084249337452746822067456002701180789771358086583482443474124411418158723119542725691499395010, 70393252006094465928260380523713847853043054790276203752342498843524345720869479181254177770844736742475229909001398094331443227277027839481999627375935346532160994617011674931967631207704749979486452691909208262769425600217801140643666532170870436405227181918107796586066466722736408083404721333960859527154819623176512764930485313100797310954250725587440406563720002250905187937675973908373502085694473384083617892012576847441726443474424925906524532310907340), (51039549262246703335581431867188375964283817016012840593751679666385893886449911333246916604033445111313421534751485096464132805605695577695759274272177909804162967924678615761389591736554101367648125735124244315968264987351525828706904341848033692884665134220620306258938611691134501681246294355026026571900644581947017310146103514672724227271181140462602746338559031234643055878080801320024365385096527304994888922813321631261983655095777380003331577961543252, 156897961559611082628598445517020539704758437940785625511666586155268573002566253477955109865880071422062158698147864848371286354754185598960302869999549594433364878976831194942353306498392837168151094015845106935121548266400683460042273752006247145119654772981779991163717197589669087444043847781732326020504264808764184359352768793288508488050503987081169759642379345609231654090732733585195672349933392721919398495103572833160485881162627771197020972761415917), (115374358588114304470310294095729350225006371271584041887562843925915398374465971765939465062881868754850891934206172354828619987503374717565001736837057531107394533912587236997987166995028999518797594302826825526640191751247010258474127686924907284979334287022833062251195492471240455158953237098323655295085621812992908905362702914092814867040059553349456071739943276424194070188741183687840673582059643423108158311650374410824734158108639359047667396539929559, 281200748397784138728365753261176662000316331656390278612762328774036901271233957726334763646452627733326019255952273159806695516002221653049486794778022795129195812244877856273776542705008632707018824804264693666650701014237071755703764413503533610695908948366011789355090030244973781955683250141000570564570099755443551177138852097908660570753019966192836277937664214944705273570364852139314302535669133973398709532812183089606949897527062851207891622812315993), (13963999491689861472370097393969795747923744337884378945098951402983318106052817252893515674113045729804768257833878423182774946236630892713490626741701303472245078284469119362129762060588709090522591579927544002536622845039889019597530194076278320503610661194511497530891555152990711459139435900074191379848554605495989644758948156948048291340698261490570279026042263935306750186928876426162136981259622735924741986740411711192596437223954988571669150328344350, 200306988137578463087666075388050106906326113595867978513847672089535119946222844050444466898981882394577972945407314575680728078373676586347990286467206208049229455322840111359646107789368250554009418147258001616084004457327202861166125251457761849121163269068583770449498535744027704481133125061057742212644932443041585694853630611719927770980113388549782129693028215334100004976958357889644775424696510751783689658144036530790927326884101051512232260095101199), (315104422406156445444266729065040628828397289805687698881729017897304116268413715132512639573458280088282546749573330704189205437987498951273013627662811882412387464873784281372774819972137170990186286051073271096854967850801433494537606457437290503917651608684113055263935781557788225661668562695217135426001747782622406823522022797416745243706589435971910075975342077406325742234086535443150000662537102177966837158574626539995396118937919229179948744013339868, 18402368534203767873780729399745394027714042187606751482160435600227409210255760508808142193968454505105056314125941943044515289749820509877221961411899730982771617071607003715912183799497118455119696139385769119645204430964859346797198607231809514963087775313828993548955586104738854812732988164724961329803222352136480895333766711167725841950751800062506078102796573885453966207804742233152936704548897201024946497501198153359644619853578680431985706664492509), (166368306020698806967962913285301582718120543657077451424856842045135427194999165905285831386787533937141233020812395889523128526824381356371482405724930561911974838820143704692613136377828448000191438248731786074729804177191712075881186753607665482847211600670354705200454040590226252398795042672767590247919965842894097562563074285849287181408791222153086308579316189529275814441323731020128413758246694885667148899658752657440974079833992994091742359926131195, 339167150008623599516854572019953058079448859727451190119663521048817932736894987723986914921608603516489165743907870745953969963307098552261706680132866930755314562701107239611142644202174659921608134418862922926317260572118399673793271765577587856153998465677565674035263980943482669439342417768675792256475975644299661418907546791723566334991691682247584942417488633643828863372382318364982602501847662427785017017328686633410486003210030904623424962624905327), (60041143529961939129704787619237879397619526379861658487476755036142120264305416357742914623248254895720614741896496406390616672961945676773532835341236627386632148210967727441822518104112598409429821643103064830229463899450215304653495980665731598927979778395544728286328052303419861740982186571981721745925639200230579968024690271442650551180769365629591943965922829629346502070102557362135586515608799042305485219123274707366022863009742829072943512170898420, 184191477826928817641299366224373162902964217675368465985470358224385068916438011237632806982379740211355330830997586488220944198862949408288977413169757638004225247752921267086731985776473175239584173635467685181586255659062847531807351869931193782902754283120477727974147306047105904638383485496993861501355581920916235603102063497239846347389859519294743772564849250196998958178432111411558367842340828928847403577259841869900729195983104563130722668231895287), (345910834886189836136742028200874931720960954681507164887490353200663797656336171852572269200513632569370396662198181444952020014966442624097776589725589412984013936303925974601114316647880776380704467060615647848641165882775895904202531785158921857214227670207583063179569834282344824048169205949349748553711805786184339769186595437202634126989519224608828450983122610808940435846695238205684113272231163218663380889548849702689673770502877465623711002652986831, 71868699069622632523199082793047303092593281282745661642064086685802230514605604152597194187309155966908707017739680461302144518482541531070950746464532959174265137419172307074360699547138010427999520547733413754004029096038468356242778116470296383624986095780906846813014682113993475135007298646900024209861724083645585624497425985732210070632768262841552117431671822824474324695143112400080221104666561213010844438839023606206337118990212886443754620445651114), (299922279822420174270052951512923484829413960165323186880487216095103922295958270759850767774277329753424392433370590311383516730570135086753260799390182382340567188297180953224189202454567298208741110242258216689707469674738243983288692519025444701330290933723313247663241878625255060875310442943122785034603434068494733538260586652156991532140053401470027480144481025940412022722171639097149124271434735761805821446184926225684026216966671668451794225093746379, 176448777326334583163448524025194284072581960394136826540427916384965712683345068953225659229016766450170599761246391721556597554720267950140764922533559001289843432251516805078016765494027368606331525984996864798641718901091683238911756628866622907895423004200944979450698985529024384620785682834103702020230085975350332441146769403628370116877435588034637052972014933357355174721983769160732094954447160225465625336178042057901916164349225643309252669498459584), (248653403282788270133425989326462306119796068443540247830959778242065796854964344369908670740380304320752207217621129706284985737853237194315178434743417786217607631940768517171007915968856396126891982657777824539233745093328041653011722204339764950803656659516378969518769666586325983221234485863309603882681327778635226910716789435662454993907339123174386714802005129172770890213585937382767223541886171238408260053586978962382746245027340679966039520744501322, 316399132172494850879253278814446444346189164060972226711314091436421075923187183319481714107280785984274084733742401493331260154993387058104823686154517244301530253102305905885044723882899773079491960350707473483301650412061811731973752030655963051282766064127774307396470793421771039790613561532369367449799492827010956925297763940763762087343909170283465475155123873803227426650498638258057448516663816013279552227833884518547737527661906158236982238139142057), (277043673067586285478059925967361025134969638669068967670998007630839812216107900628868088471357737934715922659240252130904358600960951140100740627790423633315373429560720257445216651696501798911207642816362977796543471407249242851722883160016915307943987063558705940614049611120815534220247539465462653844575143677705586392688757031070618023042859139123298749633977305412777510993890156140884957285976222929139548886817485792566779641430367396391653972174658623, 87345063937463120864030273997422816832520784207244035298276033033362036258486387122503002754397320843436337693768436850752026937489837574117590814317652418596253167254176998526575363624590273613760941395899667095434407752478961089358577275401366955840218101185303376697492569671808222755282635023380771250976551841437369330253978055965204703328899026044895019692646724206544016896329505579012256294399452678346354960733475749451541819080927783038063063637454305), (286285559939767950901027276346387635417447124910610250073381604210434868798466110736345588013454318904949296187729923707479203670677317954855805589512910247694810540594937785181618796026762455791364357708822111591213665210780666369283053682658244664784485756385306276700622778391898375990619039174104192343300029119111951847085039714577747091072052358882057671083892055904358630499701904123592443454635921698187089976804956320525580664228203043748373691897389286, 108398234167366876771292960735902250195167535279019723835504038366216470585234599995037807387102393448671609708583817295046933256413757444758542538628782139922346367399846651460107874965658647966108548770693179817592784331982665442684343022081870036844435174588915252812295561940999937888769029467921920856694247314960201504537893789419432873465154093606287111609473565260420378694216506247752627960469226733494274165089746137947867934349621055950814442134122947), (158464806825830244906457678280938926408146959855506968421240727235465693174824053788045736220457382402244730394328159759472250779670658770453625410898838866239112557719796341524502394218494782262066585243916819861199034305424478042398476987552906635709878042795146626623025989626735072646513031719346777441221893286220190777983574357207773658288384251539433038083517636199899512143656184105528365116066185195238189976530185904179237317138616750141958007458292312, 202355715764602560832117279815415639094555578944657603304300919381684913147979779360396035396874009272538901899657686094067285769799568154415539826535059328525225650084628242525847556241999705827609684525081860534485565743108562777717196734662305576631558970043336085449861887528799031243135772559554019703844741898522438595623468384991719151643066956853623897909638456788547562737966533489142722496136120096730258432781322892725238804059925261121042331125640842), (73441084417130657143437357368324627257709372907450720095976909460718894169861494558415750757612686634978557755062679346350317911497183010525917586716618441943210903302821366045203509633168568379610551381051861945127762913273762653562028402026031790728563644545282252362731131402543901167957397916563303071138153725665943773353055325160060742295021484807684614653660958299599368317208407817780262026446169795884728405943256826329559793414058050591820296528822002, 254548035993987591684255771561280206834067322892768796175747103748386858507564532601475971199381314869835252922577708519024494006803922674381292054008429196550402928961505345500700879919379337219635280305814059790327987813987766386875632082844035707959986305847922818009077161949033619144329732678697796627244018543972958176324200709735979037820529289001423671039650430604596709435800620659294865070821708253857211171242779916765125602169293746902708206161384081), (284622575314449929250620069392883633987322079821279351488850539214427641714294514746701835386829318041785987041978068054996701157560317705772440286185189663586318624085745045465165326168493732368954937733330898931022665521425148663656754281576882849633871628002770797197407055212617529047282489467347023162713186347442142259479891413409537034709961175874174318361052978186045028337058111240953641919999325360988974374823913690765757609489760252854473409195558390, 154290739515290447335840548564088792276099882626948174989039303131745662633541006196286601916522355462431475028685182306771777370803732482763650983718283278176136847797458910861100598592334594245920665955409788843631468310079126770234437301821201255463724086605733386875996165372849183376272592326142198549025971034713408672944954152480063217744032690884145529449187146438190295726689689339016534270813582548561414452125809959542007690265914934577546216175113679), (43770727862564001302893236006554669321467349967788290500692232792158250212472031731007030443425435995087084562084005221718425251654471442018717501859722554739825152527127134422197753814184872690733387366355705248658427003302093600098590746232810831115529478613738908233989622903420549993315089537553352249615018711791870813084961970926198877349258324683076039354310501229219586997376454287848620859248920202363457346653231782749214967208968052405541428333225216, 166983229790513362716241566740356845634349484487072754921022487730292810637426501865777792254511301004833973960404615903894040561008436159312970728280322456587692835149227629358820004349976792160193063511091326333430349114356448966917525119375222387907177522847501878294669993081391160470622670594433238367264482893212138818780056024143519814747632308337769249710040291052177265321694969508752694114625855794475344028849792286143303018786374679139703770142063730), (116255918458047834110626639400268842343187162534295744829296281910208187287302443094017207738141752704477429515694590974473194008006760745097721325640002773782181526021955573342203014993018767696279680874270528275229179951430272806858044669549111458876792360641594757602792741640277201589419244084567406932282818310818998710747897431884717941898833278965482770786583402922628977122986790666717946173427526953448316353531204715884856645364426281065074765024461080, 186706745028830930958010655644203817819814162748653058770046892517179916395049539247355406046230372552974988598819081345418792311081717578605491381551176832425210314622393531967611532501030582824414447441378358474098094938087379633225626696828159988806543855134457024863024375205568595155498941750170749118482093058544405529132264358571780887019928799142028427698237519089356464989187435584797597036311516271314074365194546565782110456306717379241209941080999441), (188294830099994218592990222338100646054793337528200063889616643315430269889366173364423860115258720465208116973053704979951436580763567190701380731405669672758820242060693007032559125807802477501137785628416403924523408254996123360843273789374576397653061466104729374877435343532417609671816229969568376391162766071037472224893604261516677866784471073020303974073170069701268572312083281857241269406381787527587122414630529966858897184575771597423264185587433176, 294002706091722566682964128822510390738842769824571722571698523617890968265761368877290073735381321015032617764659427189345969313947384790627253917123599253095603037845812459581892616319132541506627531436411371483253453913036136516967591161817320708446786104415568426904559308657417863225341437880557668872772968334895707618265800380453154759628710734269922045207766088960600068579396372576445840609060991887640860220092962514969995038532726727287243254642007779), (258333457390270660376202063940710921624684018395082128889082351657857861818387612823146994735628615373032780819558548124011335840302950135184513953587077613730827577072124741543541173370008885954830124023268203467929642904597790127642122110443386232275848975314193039220241122431157655543921125761857983003255098602783305854125535738883322429023306218688386533727150270226878854372403496156584262990881716920981747592690041382501850789569511773535442264631149488, 322673801246068258496236291963700137204774123805103502956795491547213057692196919373499595668407682089242569033710750198340711179594124724514896766518787422596773193306167519267647109618244302457913673188747383251512836557238254040768024153924351758771678261985947536458723658385322000912991587483204626732767077407457208601621669531302027331621481226536384676880733590920294908743088505076693622172411641220795980281716511696715645042023524390747624368207301221), (204592371207125353214074966678962017294592941889706437824601702588411319312383541086006299762354884254127502341500799949223656818850161067512825343114484790462797205438063632439876373202800357463112597638117648862487141069601508385412724240710621334920858835702236987015780207109876601112855761391082961990646806503024617688949701661131320929499797920099224563727940044967782856655078445785579363648868553955172358477658982147186194185825863087039561101054470131, 108412848101603693019845229174207437929146347437235325518110049154159067253293462648329967294189879347627308143704124791937420337631207141397724084364275648396828141767955865236680482379516819767490338387305107909062844182936285990742242152873198765655014037590318052305046882227469957071051981497422591075561830996290372570585744838739188867382924827481949000977976675323914768498799178899287506318795379913824801162945900201430026330902081829893911064321429936), (246814981484154914410225413643889625495990068155338565468265378461933253336606426565897667796294287433503852754282367280274926799835809254490894877255576153842451985818427656990580343828344860016707320656958040256509729903408908956889904889344972686476449387783876563872301937116412907019389843740721408742003459308176888188783263009535001825981510745884602421448629015932904681060879514345517418310289153248241260167554554666828367777307799595896610778449226774, 310545407774940850878546631276075513931585583590228287235552880750780524820114847643468408676452356178621929829723067798183918702079891825466010230866970814075004127761733240779610591514463223972876144469375137884822915599244405582801656646233428870643790040063438878829291036874170306720582807018859803036812652047091376896867456097815970489939127545085773237921517058397998848626433351176687184391699541768967752757792083853475861914490550807176054697308124447), (53998933276010202848191050866814804160430085565392105234511064213079043584714956645399353821833694858027202282400565708327600861696139012723814622221060804502824043235808532317480247987492041134813056917460958676161879528011660787773375763579302393433744378299825195100321786537192129407431584846372619806067814774310986068156345286034772965429891165452262310813032208254767410615053833887627700482461738920220086647267336424254318142138332171385256494040917795, 263807937229693844419038229715033369504695986238467762584837086215923835391626245174306647407157418577353967288159042728142627810812837382079265762235625694232354391032100546661289148209694137151243737798409889753798947357617440672634389646246677531109484914840817282764163891330460102090746334641533307425478333823547594815525823664328764711578275360664979725246337188299941524551128758090601719024965089214035870128563899192644146882168213929242857766534377435), (314998929050848508789279918622089649618759379778164613436144709229239679520415344545894028711312399474083220096546230516431981558141006903118270231552862748214369103321695748260028231980525210216571732993030538294674199553257896782892577322179152867181972860126125383018279739554647129559150804502181264013695060649108255304540449989392808860009040713539907386492076249291593093913178256843249241977336647154125673790061351518032872968086113990994343420656117124, 5543719864921363015961167133095571026922121122621784179326965291518137565456573018275322707532348085905727395542730547664052100960511194745391234890842058419078411035697366359223672968260877543277024797157855167762450813587170646228770066052691660840206070811113823830345871184202415491131353084353919525981008030507200241852913407885477748920306746429298947068283499565660477237718264227366203233863519261709454129310760210855123512516131621428947296751685395), (251765837558317181027559542752343499303014910980659622957857613501220763779716184124529809703726683001568747337413903660286606379026158874491150495266842763227398723718379089992835132422544751752742472754803359064246184872541991242311651418754835250103924895373628518614347291462619734390481170528653949037646597088659072896475314580936637372259124872986404823629283454648055391482788444830904757500457600941830698775465385776747248403431764419663316927127512404, 212229562540307907338669819964250171373583128773318703232960616587432580402260021381139956667543440058336059537160804102846939802666385789614732368780679978922050789919485460668407096458341379952831739445349844153210293816993919143992418689967334920825009715707438608398483163173475123142211797323578073536939878259957734673203256520093240980302706921757405705688969756853551833091628207870112942395598898781202794690510551547016305492240563946116137459581604437), (263698313547504528086539891572444939256785811022606016448440914803192261816997180484414434616226682554301579331196922950040487913011592068106192583617659751012670018389618801117018674405564403488741564962375407926131662879261394297121033708195257783532466122303396105324018676384414523806788956640409331046954915805019681140712905921883103247557397546231309436655907253576270751940298830459389265547991729263482659659411626655129121887376454509702947821282599894, 292958216152422951577959625925922036214185768279433111227829980644212789953836429187819762776157392386994005079251544238398412893777111156640047155482926718790648368882972487438623377530743101050322999443980439073205999816366159107990782218927689595010613437901894939702507315250829685428817570973975138457663207636346000747954801748899443458158415008161122641918361368119564543215317142178196440873784914349552947871417701096608944279342631443705559611975211284), (3698818237356376470296441110393071398693976848601597846965816850479460711764796921637467685432532577736794219984114715347083486976320868647593998622638528391728678072548277062604349699814754423614170673878876635769019884071699095028293344681209650625976101646359261341668626281347404696045316752820497164146497836668154353774775909967882013481491503443457425663425857719774688442372595802882091520984260234189982025773264255172890237916349913673658614388264162, 243186784326322047597331574364208383440407104104435927257432092334332710427795513899914583351787715177038600462190450183939037500366476214569616788322544819691299759623670899849694257678883398852868239080047232782637499782432012313481499348079580652749014920650946306274085140392407780442680585010131101421294769765421334073954104043550634819673554200470254830387116136230541269102711443893190509708068485861824336990511239434032445285793736598607935062240327671), (157610362361502425990644377800531511375316772481826178371748608951861122488217302104246173509919003127124247263648919776475510462891436914132348092378887316030890120768072203254545162396664424815834264108798002063318756689049574125285923178517563867046506605036852249272692867277122689535180339161639770164720737686005602365978498155975801190187674495531290301649352808277357264355153922532759952698749540351290964597813473327105144144292986019681495235201162847, 153150663691542594414790755321077494858745358785069859629060804855955342844714110446524946879925962052981681620099752432303330547929161452790245798975374150693498271067106930623174519953285408008757852929752618281377806531576934924414441682876793376527090988245310141257584062931700165876000114575681165977871619417746418279789550600593731424683534024872251875034890174634998699664032791097842882005117037032471826721884913390976303085671481820191341511253638051), (322043727695751707222208351117499107410749084158006041006087391941017550616861318474939555650722546250605343741245592122063879549723417876978183595594992176909888530537164800387987727050671273288794235658469762246179573367218054322380176457328200784272645209294794783890160992450736547533744700042794623396154532615686692863810824683083827229115255374716139026233622783484004462819013931812048875085315892388827988606494581900029950246298127808743687954306357240, 147981927499671315266335845565336772692683056914717595386914979878836621990796875452882136447716223612804669936323123004845852648800456969390897988364931665215711776506049363455487265767033088935448836624194517546863757088065469288115217990169107901414436577908305732102671999318485408350574450344835400412883663663620575470105340072782233446905136205396205168635556901737754581126141280423195124751661635082902847858109812880715083991245947029616583530713530518), (236725776784615274098542794464463862259655187308296681192440182979938536312306056225545303051748293534688002094972805616565742964018766524849648299895081600216696891541005009774883734972295392598384402938111619043734531930159525972315999914753856413369925800067574939587473128629409429695914618422026253562885004422181223909391884809897331276278206460011399567721575385236653007312549491352818399756377986075430064793263241578718719306419240350888676866443363933, 288268416533191305843422896839346790940107911295934053301301027782504718736718959392834030505895485106811962061971143264274463573800605163180043374596534387676188149729482076759421826933180777725223662321995349007539645216997841717531551562508788764503791472061998557674385282103048746478267658148404490299803508420550223996484343314049694502977560694733292302320462804019420827416713468905657223688293366954707285467324456877141605909187388320742938329834711776)]
flagct = b'N\x0ej\x02\xdf\xfb{\xf3\x82t\xf2z\xd6\xa6\xdcm\x8e\xff\xd5\xd6}\xb7\x97\xf6\x8d\xf4f\x0e;\x04\x99\xdd\xf7lw\xbcl\xf9?]\xfc\xcb\xff\xf6\xb1h\xaa\xdc'

def getMulN2(idx1, idx2, idx3):
    u1 = chimera[idx2][0] - chimera[idx3][0]
    u2 = chimera[idx3][0] - chimera[idx1][0]
    u3 = - u1 - u2
    assert u1 + u2 + u3 == 0
    assert u1 * chimera[idx1][0] + u2 * chimera[idx2][0] + u3 * chimera[idx3][0] == 0
    ret = 0
    ret += u1 * (chimera[idx1][1] ** 2 - chimera[idx1][0] ** 3)
    ret += u2 * (chimera[idx2][1] ** 2 - chimera[idx2][0] ** 3)
    ret += u3 * (chimera[idx3][1] ** 2 - chimera[idx3][0] ** 3)
    return ret

v1 = getMulN2(0, 1, 2)
v2 = getMulN2(3, 4, 5)

N2 = GCD(v1, v2)

for i in range(2, 100):
    while N2 % i == 0:
        N2 //= i

n = Integer(N2).nth_root(2)
print("n = {}".format(n))

x1 = chimera[1][0]
u1 = chimera[1][1] ** 2 - chimera[1][0] ** 3
x2 = chimera[2][0]
u2 = chimera[2][1] ** 2 - chimera[2][0] ** 3 

a = int(((u2 - u1) * inverse(x2 - x1, n * n)) % (n * n))
b = int((u1 - a * x1) % (n * n))

def ceil(n, m): # returns ceil(n/m)
	return (n + m - 1) // m

def is_inside(L, R, M, val): # is L <= val <= R in mod M context?
	if L <= R:
		return L <= val <= R
	else:
		R += M
		if L <= val <= R:
			return True
		if L <= val + M <= R:
			return True 
		return False

def optf(A, M, L, R): # minimum nonnegative x s.t. L <= Ax mod M <= R
	if L == 0:
		return 0
	if 2 * A > M:
		L, R = R, L
		A, L, R = M - A, M - L, M - R
	cc_1 = ceil(L, A)
	if A * cc_1 <= R:
		return cc_1
	cc_2 = optf(A - M % A, A, L % A, R % A)
	return ceil(L + M * cc_2, A)

def sol_ex(A, M, L, R):
	if L == 0 or L > R:
		return True
	g = GCD(A, M)
	if (L - 1) // g == R // g:
		return False
	return True

def solve(A, M, L, R, S, E):
	if sol_ex(A, M, L, R) == False:
		return []
	cur = S - 1
	ans = []
	num_sol = 0
	while cur <= E:
		NL = (L - A * (cur + 1)) % M
		NR = (R - A * (cur + 1)) % M
		if NL > NR:
			cur += 1
		else:
			val = optf(A, M, NL, NR)
			cur += 1 + val
		if cur <= E:
			ans.append(cur)
			assert is_inside(L, R, M, (A * cur) % M)
			num_sol += 1
	return ans

left = - (1 << 768) - b + n * n 
right = (1 << 512) - b + n * n
Gx = solve(a, n * n, left, right, 0, 1 << 256)[0]
Gy = Integer(int((Gx ** 3 + a * Gx + b) % (n * n))).nth_root(2)

assert (Gy ** 2 - Gx ** 3 - a * Gx - b) % (n * n) == 0
assert 0 <= Gx < (1 << 256) and 0 <= Gy < (1 << 256)

E = EllipticCurve(Zmod(n * n), [a, b])
mod = n * n

def point_double(x, y, z):
    t = (3 * x * x + a * z * z) % mod
    u = (2 * y * z) % mod
    v = (2 * u * x * y) % mod
    w = (t * t - 2 * v + mod * 3) % mod
    x2 = (u * w) % mod 
    y2 = (t * (v - w) - 2 * (u * u * y * y)) % mod
    y2 = (y2 + mod) % mod
    z2 = (u * u * u) % mod
    return x2, y2, z2
 
def point_add(x0, y0, z0, x1, y1, z1):
    if x0 == 0 and y0 == 0:
        return x1, y1, z1
    if x1 == 0 and y1 == 0:
        return x0, y0, z0
    t0 = (y0 * z1) % mod
    t1 = (y1 * z0) % mod
    t = (t0 - t1 + mod) % mod
    u0 = (x0 * z1) % mod
    u1 = (x1 * z0) % mod
    u = (u0 - u1 + mod) % mod
    u2 = (u * u) % mod
    v = (z0 * z1) % mod
    w = (t * t * v - u2 * (u0 + u1)) % mod 
    w = (w + mod) % mod
    u3 = (u * u2) % mod
    x2 = (u * w) % mod
    y2 = (t * (u0 * u2 - w) - t0 * u3) % mod
    y2 = (y2 + mod) % mod
    z2 = (u3 * v) % mod
    return x2, y2, z2
 
def point_mul(x, y, z, n):
    xr, yr, zr = 0, 0, 1
    while n:
        if n % 2 == 1:
            xr, yr, zr = point_add(xr, yr, zr, x, y, z)
            n -= 1
        n = n // 2
        x, y, z = point_double(x, y, z)
    return xr, yr, zr

def get_homomorph(x, y):
    xf, yf, _ = point_mul(x, y, 1, gift)
    yf = yf * n 
    g = GCD(xf, yf)
    xf //= g 
    yf //= g 
    return int((xf * inverse(yf, n)) % n)

A = get_homomorph(Gx, Gy)
A = inverse(A, n)

n = int(n)
dlog_res = []
for i in tqdm(range(64)):
    val = get_homomorph(chimera[i][0], chimera[i][1])
    dlog = int((val * A) % n)
    CC = dlog * E(Gx, Gy)
    FUCK = int(n) * E(Gx, Gy)
    for j in range(1 << 14):
        if int(CC.xy()[0]) == chimera[i][0]:
            dlog_res.append(dlog + j * n)
            break
        CC += FUCK

for i in range(64):
    CC = int(dlog_res[i]) * E(Gx, Gy)
    assert CC == E(chimera[i][0], chimera[i][1])

M = Matrix(ZZ, 64, 65)

for i in range(64):
    M[i, 64] = dlog_res[i] * (1 << 1024)
    M[i, i] = 1

M = M.LLL()

CV = [0] * 48 + [128] * 64
F = Matrix(ZZ, 65, 113)
for i in range(64):
    for j in range(48):
        F[i, j] = int(M[j, i]) * (1 << 1024)
    F[i, 48 + i] = 2
for i in range(64):
    F[64, 48 + i] = -256
F[64, 112] = 1

for i in range(47):
    print(M[i])

F = F.LLL()

for i in range(16):
    print(i, F[i])

final_vec = [[0] * 64 for _ in range(16)]
for i in range(16):
    isok = True
    for j in range(48):
        if F[i, j] != 0:
            isok = False
    cc = [0] * 64
    for j in range(64):
        cc[j] = (F[i, 48 + j] + 256 * F[i, 112]) // 2
    if all([0 <= cc[i] < 256 for i in range(64)]) == False and all([-256 < cc[i] <= 0 for i in range(64)]) == False:
        isok = False
    assert isok
    for j in range(64):
        final_vec[i][j] = abs(cc[j])

P = getPrime(1024)

Final_Mat = Matrix(GF(P), 64, 16)
for i in range(64):
    for j in range(16):
        Final_Mat[i, j] = final_vec[j][i]

vec = vector(GF(P), dlog_res)

ans = Final_Mat.solve_right(vec)

tot = 0
for i in range(16):
    assert 1 <= int(ans[i]) <= n
    tot += int(ans[i])

tot = int(tot) * E(Gx, Gy)

key = hashlib.sha256(str(tot.xy()[0]).encode()).digest()[:16]
cipher = AES.new(key, AES.MODE_CBC, b"\0" * 16)

print(cipher.decrypt(flagct))